{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "user-profile",
  "title": "User Profile",
  "description": "A form component for editing user profile information including name and avatar.",
  "dependencies": [
    "@better-auth-ui/react@*",
    "better-auth",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "card",
    "field",
    "input",
    "skeleton",
    "spinner",
    "user-avatar"
  ],
  "files": [
    {
      "path": "src/components/settings/account/user-profile.tsx",
      "content": "\"use client\"\n\nimport {\n  type AnyAuthConfig,\n  useAuth,\n  useUpdateUser\n} from \"@better-auth-ui/react\"\nimport { Pencil, Save } from \"lucide-react\"\nimport { useState } from \"react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport {\n  Card,\n  CardContent,\n  CardFooter,\n  CardHeader,\n  CardTitle\n} from \"@/components/ui/card\"\nimport { Field, FieldError, FieldLabel } from \"@/components/ui/field\"\nimport { Input } from \"@/components/ui/input\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport { Spinner } from \"@/components/ui/spinner\"\nimport { UserAvatar } from \"@/components/user/user-avatar\"\nimport { cn } from \"@/lib/utils\"\n\nexport type UserProfileProps = AnyAuthConfig & {\n  className?: string\n}\n\n/**\n * Render the current user's profile editor UI.\n *\n * Renders a form that displays the user's avatar and identity, lets the user edit their name with inline validation, and submit changes. While session data is loading it renders a skeleton variant; while a submit is pending it disables inputs and shows a spinner.\n *\n * @param className - Optional additional CSS class names applied to the card container\n * @param config - Authentication/configuration options forwarded to auth and user-update hooks\n * @returns A React element containing the user profile form and controls\n */\nexport function UserProfile({ className, ...config }: UserProfileProps) {\n  const context = useAuth(config)\n  const { authClient, localization } = context\n\n  const { data: sessionData } = authClient.useSession()\n  const [state, formAction, isPending] = useUpdateUser(context)\n\n  const [fieldErrors, setFieldErrors] = useState<{\n    name?: string\n  }>({})\n\n  return (\n    <form action={formAction}>\n      <Card className={cn(\"w-full py-4 md:py-6 gap-4 md:gap-6\", className)}>\n        <CardHeader className=\"px-4 md:px-6 gap-0\">\n          <CardTitle className=\"text-xl\">\n            {localization.settings.profile}\n          </CardTitle>\n        </CardHeader>\n\n        <CardContent className=\"px-4 md:px-6 grid gap-4 md:gap-6\">\n          <div className=\"flex items-center gap-3\">\n            <Button\n              type=\"button\"\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"relative p-0 h-auto w-auto rounded-full\"\n              disabled={!sessionData}\n            >\n              <UserAvatar {...config} className=\"size-12 text-base\" />\n\n              <span className=\"absolute right-0 bottom-0 size-4 rounded-full bg-background ring-2 ring-secondary flex items-center justify-center\">\n                <Pencil className=\"size-2 text-muted-foreground\" />\n              </span>\n            </Button>\n\n            {sessionData ? (\n              <div className=\"grid flex-1 text-left text-sm leading-tight\">\n                <span className=\"truncate font-medium\">\n                  {sessionData?.user?.displayUsername ||\n                    sessionData?.user?.name ||\n                    sessionData?.user?.email}\n                </span>\n\n                {(sessionData?.user?.displayUsername ||\n                  sessionData?.user?.name) && (\n                  <span className=\"text-muted-foreground truncate text-xs\">\n                    {sessionData?.user?.email}\n                  </span>\n                )}\n              </div>\n            ) : (\n              <div className=\"flex flex-col gap-1\">\n                <Skeleton className=\"h-4 w-24 mt-0.5\" />\n                <Skeleton className=\"h-3 w-32\" />\n              </div>\n            )}\n          </div>\n\n          <Field className=\"gap-1\">\n            <FieldLabel htmlFor=\"name\">{localization.auth.name}</FieldLabel>\n\n            {sessionData ? (\n              <Input\n                id=\"name\"\n                name=\"name\"\n                defaultValue={sessionData?.user?.name || state.name}\n                placeholder={localization.auth.name}\n                disabled={isPending}\n                required\n                onChange={() => {\n                  setFieldErrors((prev) => ({\n                    ...prev,\n                    name: undefined\n                  }))\n                }}\n                onInvalid={(e) => {\n                  e.preventDefault()\n                  setFieldErrors((prev) => ({\n                    ...prev,\n                    name: (e.target as HTMLInputElement).validationMessage\n                  }))\n                }}\n                aria-invalid={!!fieldErrors.name}\n              />\n            ) : (\n              <Skeleton className=\"h-9 w-full\" />\n            )}\n\n            <FieldError>{fieldErrors.name}</FieldError>\n          </Field>\n        </CardContent>\n\n        <CardFooter className=\"px-4 md:px-6\">\n          <Button type=\"submit\" disabled={isPending || !sessionData}>\n            {isPending ? <Spinner /> : <Save />}\n\n            {localization.settings.saveChanges}\n          </Button>\n        </CardFooter>\n      </Card>\n    </form>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/user/user-avatar.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport type { User } from \"better-auth\"\nimport { User2 } from \"lucide-react\"\nimport type { ReactNode } from \"react\"\n\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { cn } from \"@/lib/utils\"\n\nexport type UserAvatarProps = AnyAuthConfig & {\n  className?: string\n  fallback?: ReactNode\n  isPending?: boolean\n  user?: User & { username?: string | null; displayUsername?: string | null }\n}\n\n/**\n * Display a user's avatar using session information or an explicit user prop.\n *\n * Renders a circular avatar that shows the user's image when available, a fallback node if provided, or the user's first two initials; while the session is loading (or when `isPending` is true) and no `user` prop is supplied, renders a skeleton placeholder.\n *\n * @param className - Additional CSS classes applied to the avatar container\n * @param user - Optional user object to display instead of the session user\n * @param isPending - When true, treat the component as loading and show the skeleton if no `user` is provided\n * @param fallback - Node to render inside the avatar fallback area before initials or the default icon\n * @returns The avatar element to render (JSX)\n */\nexport function UserAvatar({\n  className,\n  user,\n  isPending,\n  fallback,\n  ...config\n}: UserAvatarProps) {\n  const { authClient } = useAuth(config)\n\n  const { data: sessionData, isPending: sessionPending } =\n    authClient.useSession()\n\n  if ((isPending || sessionPending) && !user) {\n    return <Skeleton className={cn(\"size-8 rounded-full\", className)} />\n  }\n\n  const resolvedUser = user ?? sessionData?.user\n\n  const initials = (\n    resolvedUser?.username ||\n    resolvedUser?.name ||\n    resolvedUser?.email\n  )\n    ?.slice(0, 2)\n    .toUpperCase()\n\n  return (\n    <Avatar\n      className={cn(\n        \"size-8 bg-muted text-foreground text-sm rounded-full\",\n        className\n      )}\n    >\n      <AvatarImage\n        src={resolvedUser?.image ?? undefined}\n        alt={\n          resolvedUser?.displayUsername ||\n          resolvedUser?.name ||\n          resolvedUser?.email\n        }\n      />\n\n      <AvatarFallback delayMs={resolvedUser?.image ? 600 : undefined}>\n        {fallback || initials || <User2 className=\"size-4\" />}\n      </AvatarFallback>\n    </Avatar>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/hooks/auth/use-auth.tsx",
      "content": "import {\n  type AnyAuthConfig,\n  type AuthConfig,\n  AuthContext\n} from \"@better-auth-ui/react\"\nimport { deepmerge, defaultConfig } from \"@better-auth-ui/react/core\"\nimport { useContext } from \"react\"\nimport { toast } from \"sonner\"\n\nconst extendConfig: AnyAuthConfig = {\n  toast,\n  Link: (props) => <a {...props} />\n}\n\n/**\n * Constructs the effective AuthConfig by merging defaults, any AuthContext-provided config, and the optional `config` overrides.\n *\n * @param config - Partial configuration overrides applied on top of context and defaults\n * @returns The final `AuthConfig` with a non-optional `authClient`\n * @throws If the resulting config does not include an `authClient`\n */\nexport function useAuth(config?: AnyAuthConfig) {\n  const context = useContext(AuthContext)\n\n  const authConfig = deepmerge(\n    deepmerge(defaultConfig as AnyAuthConfig, extendConfig),\n    deepmerge(context || {}, config || {})\n  ) as AuthConfig\n\n  if (authConfig.authClient === undefined) {\n    throw new Error(\"[Better Auth UI] authClient is required\")\n  }\n\n  return authConfig\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/settings/use-update-user.ts",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { useActionState } from \"react\"\n\nimport { useAuth } from \"../auth/use-auth\"\n\n/**\n * Provides an action state hook that updates the current user's name, triggers a session refetch, and shows localized toast notifications.\n *\n * @param config - Optional auth configuration forwarded to the auth hook\n * @returns An action state (initialized with `name` = \"\") whose action updates the user's name, refetches the session on success, and displays success or error toasts\n */\nexport function useUpdateUser(config?: AnyAuthConfig) {\n  const { authClient, localization, toast } = useAuth(config)\n\n  const { refetch } = authClient.useSession()\n\n  const updateUser = async (_: object, formData: FormData) => {\n    const name = formData.get(\"name\") as string\n\n    const { error } = await authClient.updateUser(\n      {\n        name\n      },\n      { disableSignal: true }\n    )\n\n    if (error) {\n      toast.error(error.message || error.statusText)\n    } else {\n      await refetch()\n\n      toast.success(localization.settings.profileUpdatedSuccess)\n    }\n\n    return { name }\n  }\n\n  return useActionState(updateUser, { name: \"\" })\n}\n",
      "type": "registry:hook"
    }
  ],
  "type": "registry:component"
}