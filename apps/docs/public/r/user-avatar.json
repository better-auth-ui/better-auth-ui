{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "user-avatar",
  "title": "User Avatar",
  "description": "Renders the current user's avatar using session data. Shows a skeleton while loading and falls back to initials when no image is available.",
  "dependencies": [
    "@better-auth-ui/react@*",
    "better-auth",
    "lucide-react"
  ],
  "registryDependencies": [
    "avatar",
    "skeleton"
  ],
  "files": [
    {
      "path": "src/components/user/user-avatar.tsx",
      "content": "\"use client\"\n\nimport type { User } from \"better-auth\"\nimport { User2 } from \"lucide-react\"\nimport type { ReactNode } from \"react\"\n\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport { useSession } from \"@/hooks/auth/use-session\"\nimport { cn } from \"@/lib/utils\"\n\nexport type UserAvatarProps = {\n  className?: string\n  fallback?: ReactNode\n  isPending?: boolean\n  user?: User & { username?: string | null; displayUsername?: string | null }\n}\n\n/**\n * Display a user's avatar using session information or an explicit user prop.\n *\n * Renders a circular avatar that shows the user's image when available, a fallback node if provided, or the user's first two initials; while the session is loading (or when `isPending` is true) and no `user` prop is supplied, renders a skeleton placeholder.\n *\n * @param className - Additional CSS classes applied to the avatar container\n * @param user - Optional user object to display instead of the session user\n * @param isPending - When true, treat the component as loading and show the skeleton if no `user` is provided\n * @param fallback - Node to render inside the avatar fallback area before initials or the default icon\n * @returns The avatar element to render (JSX)\n */\nexport function UserAvatar({\n  className,\n  user,\n  isPending,\n  fallback\n}: UserAvatarProps) {\n  const { data: sessionData, isPending: sessionPending } = useSession()\n\n  if ((isPending || sessionPending) && !user) {\n    return <Skeleton className={cn(\"size-8 rounded-full\", className)} />\n  }\n\n  const resolvedUser = user ?? sessionData?.user\n\n  const initials = (\n    resolvedUser?.username ||\n    resolvedUser?.name ||\n    resolvedUser?.email\n  )\n    ?.slice(0, 2)\n    .toUpperCase()\n\n  return (\n    <Avatar\n      className={cn(\n        \"size-8 bg-muted text-foreground text-sm rounded-full\",\n        className\n      )}\n    >\n      <AvatarImage\n        src={resolvedUser?.image ?? undefined}\n        alt={\n          resolvedUser?.displayUsername ||\n          resolvedUser?.name ||\n          resolvedUser?.email\n        }\n      />\n\n      <AvatarFallback delayMs={resolvedUser?.image ? 600 : undefined}>\n        {fallback || initials || <User2 className=\"size-4\" />}\n      </AvatarFallback>\n    </Avatar>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/hooks/auth/use-session.ts",
      "content": "export { useSession } from \"@better-auth-ui/react\"\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/auth/use-session.tsx",
      "content": "import { useAuth } from \"@better-auth-ui/react\"\nimport { type DefinedInitialDataOptions, useQuery } from \"@tanstack/react-query\"\n\n/**\n * Fetches and returns the session data.\n *\n * @param options - Optional query options.\n * @returns Query result containing session data, loading state, and error state\n */\nexport function useSession(options?: Partial<DefinedInitialDataOptions>) {\n  const { authClient } = useAuth()\n\n  return useQuery({\n    queryKey: [\"auth\", \"session\"],\n    queryFn: () => authClient.getSession({ fetchOptions: { throw: true } }),\n    ...(options as object)\n  })\n}\n",
      "type": "registry:hook"
    }
  ],
  "type": "registry:component"
}