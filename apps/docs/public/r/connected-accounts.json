{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "connected-accounts",
  "title": "Connected Accounts",
  "description": "Display and manage connected social accounts. Shows all linked social accounts with the ability to unlink them, followed by available providers that can be linked.",
  "dependencies": [
    "@better-auth-ui/react@*",
    "better-auth",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "card",
    "skeleton",
    "spinner"
  ],
  "files": [
    {
      "path": "src/components/settings/security/connected-accounts.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { providerIcons } from \"@better-auth-ui/react\"\nimport { getProviderName } from \"@better-auth-ui/react/core\"\nimport { Link, X } from \"lucide-react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport { Spinner } from \"@/components/ui/spinner\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { useSession } from \"@/hooks/auth/use-session\"\nimport { useLinkSocial } from \"@/hooks/settings/use-link-social\"\nimport { useListAccounts } from \"@/hooks/settings/use-list-accounts\"\nimport { useUnlinkAccount } from \"@/hooks/settings/use-unlink-account\"\nimport { cn } from \"@/lib/utils\"\n\nexport type ConnectedAccountsProps = AnyAuthConfig & {\n  className?: string\n}\n\n/**\n * Display and manage connected social accounts.\n *\n * Shows all linked social accounts with the ability to unlink them,\n * followed by available providers that can be linked.\n *\n * @returns A JSX element containing the connected accounts card\n */\nexport function ConnectedAccounts({\n  className,\n  ...config\n}: ConnectedAccountsProps) {\n  const context = useAuth(config)\n  const { localization, socialProviders } = context\n\n  const { data: sessionData } = useSession(context)\n  const { data: accounts, isPending: isLoadingAccounts } =\n    useListAccounts(context)\n  const { linkSocial, linkingProvider } = useLinkSocial(context)\n  const { unlinkAccount, unlinkingProvider } = useUnlinkAccount(context)\n\n  // Get list of providers that are not yet connected\n  const availableProviders =\n    socialProviders?.filter(\n      (provider) =>\n        !accounts?.some((account) => account.providerId === provider)\n    ) || []\n\n  // Get list of connected accounts\n  const connectedAccounts = accounts || []\n\n  const isLoading = !sessionData || isLoadingAccounts\n\n  return (\n    <Card className={cn(\"w-full py-4 md:py-6 gap-4 md:gap-6\", className)}>\n      <CardHeader className=\"px-4 md:px-6 gap-0\">\n        <CardTitle className=\"text-xl\">\n          {localization.settings.connectedAccounts}\n        </CardTitle>\n      </CardHeader>\n\n      <CardContent className=\"px-4 md:px-6 grid gap-3\">\n        {/* Connected Accounts */}\n        {isLoading ? (\n          <AccountRowSkeleton />\n        ) : (\n          <>\n            {connectedAccounts.map((account) => {\n              const ProviderIcon = providerIcons[account.providerId]\n              const providerName = getProviderName(account.providerId)\n              const isCurrentlyUnlinking =\n                unlinkingProvider === account.providerId\n\n              return (\n                <div\n                  key={account.id}\n                  className=\"flex items-center rounded-lg border p-3 justify-between\"\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"flex size-10 items-center justify-center rounded-md bg-muted\">\n                      {ProviderIcon && <ProviderIcon className=\"size-5\" />}\n                    </div>\n\n                    <div className=\"flex flex-col\">\n                      <span className=\"text-sm font-medium\">\n                        {providerName}\n                      </span>\n\n                      {account.accountId && (\n                        <span className=\"text-xs text-muted-foreground\">\n                          {account.accountId}\n                        </span>\n                      )}\n                    </div>\n                  </div>\n\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    onClick={() => unlinkAccount(account.providerId)}\n                    disabled={\n                      isCurrentlyUnlinking ||\n                      !!unlinkingProvider ||\n                      !!linkingProvider\n                    }\n                    aria-label={localization.settings.unlinkProvider.replace(\n                      \"{{provider}}\",\n                      providerName\n                    )}\n                  >\n                    {isCurrentlyUnlinking ? (\n                      <Spinner className=\"size-4\" />\n                    ) : (\n                      <X className=\"size-4\" />\n                    )}\n                  </Button>\n                </div>\n              )\n            })}\n\n            {/* Available Providers to Connect */}\n            {availableProviders.map((provider) => {\n              const ProviderIcon = providerIcons[provider]\n              const providerName = getProviderName(provider)\n              const isCurrentlyLinking = linkingProvider === provider\n\n              return (\n                <div\n                  key={provider}\n                  className=\"flex items-center rounded-lg border border-dashed p-3 justify-between\"\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"flex size-10 items-center justify-center rounded-md bg-muted\">\n                      {ProviderIcon && (\n                        <ProviderIcon className=\"size-5 opacity-50\" />\n                      )}\n                    </div>\n\n                    <div className=\"flex flex-col\">\n                      <span className=\"text-sm font-medium text-muted-foreground\">\n                        {providerName}\n                      </span>\n\n                      <span className=\"text-xs text-muted-foreground/70\">\n                        {localization.settings.connectProvider.replace(\n                          \"{{provider}}\",\n                          providerName\n                        )}\n                      </span>\n                    </div>\n                  </div>\n\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    onClick={() => linkSocial(provider)}\n                    disabled={\n                      isCurrentlyLinking ||\n                      !!unlinkingProvider ||\n                      !!linkingProvider\n                    }\n                    aria-label={localization.settings.connectProvider.replace(\n                      \"{{provider}}\",\n                      providerName\n                    )}\n                  >\n                    {isCurrentlyLinking ? (\n                      <Spinner className=\"size-4\" />\n                    ) : (\n                      <Link className=\"size-4\" />\n                    )}\n                  </Button>\n                </div>\n              )\n            })}\n          </>\n        )}\n      </CardContent>\n    </Card>\n  )\n}\n\nfunction AccountRowSkeleton() {\n  return (\n    <div className=\"flex items-center rounded-lg border p-3 justify-between\">\n      <div className=\"flex items-center gap-3\">\n        <Skeleton className=\"size-10 rounded-md\" />\n\n        <div className=\"flex flex-col gap-1\">\n          <Skeleton className=\"h-4 w-20\" />\n          <Skeleton className=\"h-3 w-32\" />\n        </div>\n      </div>\n    </div>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/hooks/auth/use-auth.tsx",
      "content": "import {\n  type AnyAuthConfig,\n  type AuthConfig,\n  AuthContext\n} from \"@better-auth-ui/react\"\nimport { deepmerge, defaultConfig } from \"@better-auth-ui/react/core\"\nimport { useContext } from \"react\"\nimport { toast } from \"sonner\"\n\nconst extendConfig: AnyAuthConfig = {\n  toast,\n  Link: (props) => <a {...props} />\n}\n\n/**\n * Constructs the effective AuthConfig by merging defaults, any AuthContext-provided config, and the optional `config` overrides.\n *\n * @param config - Partial configuration overrides applied on top of context and defaults\n * @returns The final `AuthConfig` with a non-optional `authClient`\n * @throws If the resulting config does not include an `authClient`\n */\nexport function useAuth(config?: AnyAuthConfig) {\n  const context = useContext(AuthContext)\n\n  const authConfig = deepmerge(\n    deepmerge(defaultConfig as AnyAuthConfig, extendConfig),\n    deepmerge(context || {}, config || {})\n  ) as AuthConfig\n\n  if (authConfig.authClient === undefined) {\n    throw new Error(\"[Better Auth UI] authClient is required\")\n  }\n\n  return authConfig\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "src/hooks/auth/use-session.ts",
      "content": "export { useSession } from \"@better-auth-ui/react\"\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/auth/use-session.tsx",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { type DefinedInitialDataOptions, useQuery } from \"@tanstack/react-query\"\n\nimport { useAuth } from \"../auth/use-auth\"\n\n/**\n * Fetches and returns the session data.\n *\n * @param config - Optional partial AuthConfig used to customize auth behavior; may include an `authClient` override.\n * @param options - Optional query options.\n * @returns Query result containing session data, loading state, and error state\n */\nexport function useSession(\n  config?: AnyAuthConfig,\n  options?: Partial<DefinedInitialDataOptions>\n) {\n  const { authClient, queryClient } = useAuth(config)\n\n  return useQuery(\n    {\n      queryKey: [\"auth\", \"session\"],\n      queryFn: () => authClient.getSession({ fetchOptions: { throw: true } }),\n      ...(options as object)\n    },\n    queryClient\n  )\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "src/hooks/settings/use-link-social.ts",
      "content": "export { useLinkSocial } from \"@better-auth-ui/react\"\n\n",
      "type": "registry:hook"
    },
    {
      "path": "src/hooks/settings/use-list-accounts.ts",
      "content": "export { useListAccounts } from \"@better-auth-ui/react\"\n\n",
      "type": "registry:hook"
    },
    {
      "path": "src/hooks/settings/use-unlink-account.ts",
      "content": "export { useUnlinkAccount } from \"@better-auth-ui/react\"\n\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/settings/use-link-social.ts",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { useCallback, useState } from \"react\"\n\nimport { useAuth } from \"../auth/use-auth\"\n\n/**\n * Provides functionality to link a social account to the current user.\n *\n * @param config - Optional auth configuration forwarded to the auth hook\n * @returns An object containing the linking provider and a function to link a social account\n */\nexport function useLinkSocial(config?: AnyAuthConfig) {\n  const { authClient, baseURL, toast } = useAuth(config)\n\n  const [linkingProvider, setLinkingProvider] = useState<string | null>(null)\n\n  const linkSocial = useCallback(\n    async (provider: string) => {\n      setLinkingProvider(provider)\n\n      const callbackURL = `${baseURL}${window.location.pathname}`\n\n      const { error } = await authClient.linkSocial({\n        provider,\n        callbackURL\n      })\n\n      if (error) {\n        toast.error(error.message || error.statusText)\n      }\n\n      setLinkingProvider(null)\n    },\n    [authClient, baseURL, toast]\n  )\n\n  return { linkingProvider, linkSocial }\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/settings/use-list-accounts.ts",
      "content": "import { type AnyAuthConfig, useSession } from \"@better-auth-ui/react\"\nimport { type DefinedInitialDataOptions, useQuery } from \"@tanstack/react-query\"\nimport { useAuth } from \"../auth/use-auth\"\n\n/**\n * Fetches and returns the list of linked social accounts for the current user.\n *\n * @param config - Optional partial AuthConfig used to customize auth behavior; may include an `authClient` override.\n * @param options - Optional query options.\n * @returns Query result containing linked accounts data, loading state, and error state\n */\nexport function useListAccounts(\n  config?: AnyAuthConfig,\n  options?: DefinedInitialDataOptions\n) {\n  const { authClient, queryClient, socialProviders } = useAuth(config)\n  const { data: sessionData } = useSession(config, options)\n\n  return useQuery(\n    {\n      queryKey: [\"auth\", \"listAccounts\", sessionData?.session.id],\n      queryFn: () =>\n        authClient.listAccounts({\n          fetchOptions: { throw: true }\n        }),\n      enabled: !!socialProviders?.length && !!sessionData,\n      ...(options as object)\n    },\n    queryClient\n  )\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/settings/use-unlink-account.ts",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { useCallback, useState } from \"react\"\n\nimport { useAuth } from \"../auth/use-auth\"\n\n/**\n * Provides functionality to unlink a social account from the current user.\n *\n * @param config - Optional auth configuration forwarded to the auth hook\n * @returns An object containing the unlinking provider and a function to unlink an account\n */\nexport function useUnlinkAccount(config?: AnyAuthConfig) {\n  const { authClient, localization, queryClient, toast } = useAuth(config)\n\n  const [unlinkingProvider, setUnlinkingProvider] = useState<string | null>(\n    null\n  )\n\n  const unlinkAccount = useCallback(\n    async (providerId: string) => {\n      setUnlinkingProvider(providerId)\n\n      const { error } = await authClient.unlinkAccount({\n        providerId\n      })\n\n      if (error) {\n        toast.error(error.message || error.statusText)\n      } else {\n        await queryClient.invalidateQueries({ queryKey: [\"auth\"] })\n        toast.success(localization.settings.accountUnlinked)\n      }\n\n      setUnlinkingProvider(null)\n    },\n    [authClient, localization, queryClient, toast]\n  )\n\n  return { unlinkingProvider, unlinkAccount }\n}\n",
      "type": "registry:hook"
    }
  ],
  "type": "registry:component"
}