{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "security-settings",
  "title": "Security Settings",
  "description": "A container component that displays security settings including password management and connected accounts.",
  "dependencies": [
    "@better-auth-ui/react@*"
  ],
  "registryDependencies": [
    "change-password",
    "connected-accounts"
  ],
  "files": [
    {
      "path": "src/components/settings/security/security-settings.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\n\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { cn } from \"@/lib/utils\"\nimport { ChangePassword } from \"./change-password\"\nimport { ConnectedAccounts } from \"./connected-accounts\"\n\nexport type SecuritySettingsProps = AnyAuthConfig & {\n  className?: string\n}\n\n/**\n * Renders the security settings layout including password management and connected accounts.\n *\n * @param className - Optional additional CSS class names for the outer container.\n * @param config - Auth-related props forwarded to the child components.\n * @returns A JSX element containing a styled container that renders the security settings.\n */\nexport function SecuritySettings({\n  className,\n  ...config\n}: SecuritySettingsProps) {\n  const { emailAndPassword, socialProviders } = useAuth(config)\n\n  return (\n    <div className={cn(\"flex w-full flex-col gap-4 md:gap-6\", className)}>\n      {emailAndPassword?.enabled && <ChangePassword {...config} />}\n      {socialProviders?.length && <ConnectedAccounts {...config} />}\n    </div>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/settings/security/change-password.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { Check, Eye, EyeOff } from \"lucide-react\"\nimport { useState } from \"react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport {\n  Card,\n  CardContent,\n  CardFooter,\n  CardHeader,\n  CardTitle\n} from \"@/components/ui/card\"\nimport { Field, FieldError, FieldLabel } from \"@/components/ui/field\"\nimport { Input } from \"@/components/ui/input\"\nimport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupInput\n} from \"@/components/ui/input-group\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport { Spinner } from \"@/components/ui/spinner\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { useSession } from \"@/hooks/auth/use-session\"\nimport { useChangePassword } from \"@/hooks/settings/use-change-password\"\nimport { cn } from \"@/lib/utils\"\n\nexport type ChangePasswordProps = AnyAuthConfig & {\n  className?: string\n}\n\n/**\n * Display a form allowing the authenticated user to change their password.\n *\n * Renders a card containing fields for current password, new password, and\n * optionally password confirmation (based on emailAndPassword.confirmPassword config).\n * Upon successful submission, all other sessions are revoked for security.\n *\n * @returns A JSX element containing the change password card and form\n */\nexport function ChangePassword({ className, ...config }: ChangePasswordProps) {\n  const context = useAuth(config)\n  const { emailAndPassword, localization } = context\n\n  const { data: sessionData } = useSession(context)\n\n  const [, formAction, isPending] = useChangePassword(context)\n\n  const [isNewPasswordVisible, setIsNewPasswordVisible] = useState(false)\n  const [isConfirmPasswordVisible, setIsConfirmPasswordVisible] =\n    useState(false)\n\n  const [fieldErrors, setFieldErrors] = useState<{\n    currentPassword?: string\n    newPassword?: string\n    confirmPassword?: string\n  }>({})\n\n  return (\n    <form action={formAction}>\n      <Card className={cn(\"w-full py-4 md:py-6 gap-4 md:gap-6\", className)}>\n        <CardHeader className=\"px-4 md:px-6 gap-0\">\n          <CardTitle className=\"text-xl\">\n            {localization.settings.changePassword}\n          </CardTitle>\n        </CardHeader>\n\n        <CardContent className=\"px-4 md:px-6 grid gap-4 md:gap-6\">\n          <Field className=\"gap-1\">\n            <FieldLabel htmlFor=\"currentPassword\">\n              {localization.settings.currentPassword}\n            </FieldLabel>\n\n            {sessionData ? (\n              <Input\n                id=\"currentPassword\"\n                name=\"currentPassword\"\n                type=\"password\"\n                autoComplete=\"current-password\"\n                placeholder={localization.settings.currentPasswordPlaceholder}\n                disabled={isPending}\n                required\n                onChange={() => {\n                  setFieldErrors((prev) => ({\n                    ...prev,\n                    currentPassword: undefined\n                  }))\n                }}\n                onInvalid={(e) => {\n                  e.preventDefault()\n                  setFieldErrors((prev) => ({\n                    ...prev,\n                    currentPassword: (e.target as HTMLInputElement)\n                      .validationMessage\n                  }))\n                }}\n                aria-invalid={!!fieldErrors.currentPassword}\n              />\n            ) : (\n              <Skeleton className=\"h-9 w-full\" />\n            )}\n\n            <FieldError>{fieldErrors.currentPassword}</FieldError>\n          </Field>\n\n          <Field className=\"gap-1\">\n            <FieldLabel htmlFor=\"newPassword\">\n              {localization.auth.newPassword}\n            </FieldLabel>\n\n            {sessionData ? (\n              <InputGroup>\n                <InputGroupInput\n                  id=\"newPassword\"\n                  name=\"newPassword\"\n                  type={isNewPasswordVisible ? \"text\" : \"password\"}\n                  autoComplete=\"new-password\"\n                  placeholder={localization.auth.newPasswordPlaceholder}\n                  minLength={emailAndPassword?.minPasswordLength}\n                  maxLength={emailAndPassword?.maxPasswordLength}\n                  disabled={isPending}\n                  required\n                  onChange={() => {\n                    setFieldErrors((prev) => ({\n                      ...prev,\n                      newPassword: undefined\n                    }))\n                  }}\n                  onInvalid={(e) => {\n                    e.preventDefault()\n                    setFieldErrors((prev) => ({\n                      ...prev,\n                      newPassword: (e.target as HTMLInputElement)\n                        .validationMessage\n                    }))\n                  }}\n                  aria-invalid={!!fieldErrors.newPassword}\n                />\n\n                <InputGroupAddon align=\"inline-end\">\n                  <InputGroupButton\n                    size=\"icon-xs\"\n                    aria-label={\n                      isNewPasswordVisible\n                        ? localization.auth.hidePassword\n                        : localization.auth.showPassword\n                    }\n                    onClick={() =>\n                      setIsNewPasswordVisible(!isNewPasswordVisible)\n                    }\n                    disabled={isPending}\n                  >\n                    {isNewPasswordVisible ? <EyeOff /> : <Eye />}\n                  </InputGroupButton>\n                </InputGroupAddon>\n              </InputGroup>\n            ) : (\n              <Skeleton className=\"h-9 w-full\" />\n            )}\n\n            <FieldError>{fieldErrors.newPassword}</FieldError>\n          </Field>\n\n          {emailAndPassword?.confirmPassword && (\n            <Field className=\"gap-1\">\n              <FieldLabel htmlFor=\"confirmPassword\">\n                {localization.auth.confirmPassword}\n              </FieldLabel>\n\n              {sessionData ? (\n                <InputGroup>\n                  <InputGroupInput\n                    id=\"confirmPassword\"\n                    name=\"confirmPassword\"\n                    type={isConfirmPasswordVisible ? \"text\" : \"password\"}\n                    autoComplete=\"new-password\"\n                    placeholder={localization.auth.confirmPasswordPlaceholder}\n                    minLength={emailAndPassword?.minPasswordLength}\n                    maxLength={emailAndPassword?.maxPasswordLength}\n                    disabled={isPending}\n                    required\n                    onChange={() => {\n                      setFieldErrors((prev) => ({\n                        ...prev,\n                        confirmPassword: undefined\n                      }))\n                    }}\n                    onInvalid={(e) => {\n                      e.preventDefault()\n                      setFieldErrors((prev) => ({\n                        ...prev,\n                        confirmPassword: (e.target as HTMLInputElement)\n                          .validationMessage\n                      }))\n                    }}\n                    aria-invalid={!!fieldErrors.confirmPassword}\n                  />\n\n                  <InputGroupAddon align=\"inline-end\">\n                    <InputGroupButton\n                      size=\"icon-xs\"\n                      aria-label={\n                        isConfirmPasswordVisible\n                          ? localization.auth.hidePassword\n                          : localization.auth.showPassword\n                      }\n                      onClick={() =>\n                        setIsConfirmPasswordVisible(!isConfirmPasswordVisible)\n                      }\n                      disabled={isPending}\n                    >\n                      {isConfirmPasswordVisible ? <EyeOff /> : <Eye />}\n                    </InputGroupButton>\n                  </InputGroupAddon>\n                </InputGroup>\n              ) : (\n                <Skeleton className=\"h-9 w-full\" />\n              )}\n\n              <FieldError>{fieldErrors.confirmPassword}</FieldError>\n            </Field>\n          )}\n        </CardContent>\n\n        <CardFooter className=\"px-4 md:px-6\">\n          <Button type=\"submit\" disabled={isPending || !sessionData}>\n            {isPending ? <Spinner /> : <Check />}\n\n            {localization.settings.updatePassword}\n          </Button>\n        </CardFooter>\n      </Card>\n    </form>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/settings/security/connected-accounts.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { providerIcons } from \"@better-auth-ui/react\"\nimport { getProviderName } from \"@better-auth-ui/react/core\"\nimport { Link, X } from \"lucide-react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport { Spinner } from \"@/components/ui/spinner\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { useLinkSocial } from \"@/hooks/settings/use-link-social\"\nimport { useListAccounts } from \"@/hooks/settings/use-list-accounts\"\nimport { useUnlinkAccount } from \"@/hooks/settings/use-unlink-account\"\nimport { cn } from \"@/lib/utils\"\n\nexport type ConnectedAccountsProps = AnyAuthConfig & {\n  className?: string\n}\n\n/**\n * Display and manage connected social accounts.\n *\n * Shows all linked social accounts with the ability to unlink them,\n * followed by available providers that can be linked.\n *\n * @returns A JSX element containing the connected accounts card\n */\nexport function ConnectedAccounts({\n  className,\n  ...config\n}: ConnectedAccountsProps) {\n  const context = useAuth(config)\n  const { localization, socialProviders } = context\n\n  const { data: accounts, isPending } = useListAccounts(context)\n  const { linkSocial, linkingProvider } = useLinkSocial(context)\n  const { unlinkAccount, unlinkingProvider } = useUnlinkAccount(context)\n\n  return (\n    <Card className={cn(\"w-full py-4 md:py-6 gap-4 md:gap-6\", className)}>\n      <CardHeader className=\"px-4 md:px-6 gap-0\">\n        <CardTitle className=\"text-xl\">\n          {localization.settings.connectedAccounts}\n        </CardTitle>\n      </CardHeader>\n\n      <CardContent className=\"px-4 md:px-6 grid gap-3\">\n        {isPending ? (\n          <AccountRowSkeleton />\n        ) : (\n          <>\n            {accounts\n              ?.filter((account) => account.providerId !== \"credential\")\n              .map((account) => {\n                const ProviderIcon = providerIcons[account.providerId]\n                const providerName = getProviderName(account.providerId)\n                const isCurrentlyUnlinking =\n                  unlinkingProvider === account.providerId\n\n                return (\n                  <div\n                    key={account.id}\n                    className=\"flex items-center rounded-lg border p-3 justify-between\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"flex size-10 items-center justify-center rounded-md bg-muted\">\n                        {ProviderIcon && <ProviderIcon className=\"size-5\" />}\n                      </div>\n\n                      <div className=\"flex flex-col\">\n                        <span className=\"text-sm font-medium\">\n                          {providerName}\n                        </span>\n\n                        {account.accountId && (\n                          <span className=\"text-xs text-muted-foreground\">\n                            {account.accountId}\n                          </span>\n                        )}\n                      </div>\n                    </div>\n\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      onClick={() => unlinkAccount(account.providerId)}\n                      disabled={\n                        isCurrentlyUnlinking ||\n                        !!unlinkingProvider ||\n                        !!linkingProvider\n                      }\n                      aria-label={localization.settings.unlinkProvider.replace(\n                        \"{{provider}}\",\n                        providerName\n                      )}\n                    >\n                      {isCurrentlyUnlinking ? (\n                        <Spinner className=\"size-4\" />\n                      ) : (\n                        <X className=\"size-4\" />\n                      )}\n                    </Button>\n                  </div>\n                )\n              })}\n\n            {socialProviders?.map((provider) => {\n              const ProviderIcon = providerIcons[provider]\n              const providerName = getProviderName(provider)\n              const isCurrentlyLinking = linkingProvider === provider\n\n              return (\n                <div\n                  key={provider}\n                  className=\"flex items-center rounded-lg border border-dashed p-3 justify-between\"\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"flex size-10 items-center justify-center rounded-md bg-muted\">\n                      {ProviderIcon && (\n                        <ProviderIcon className=\"size-5 opacity-50\" />\n                      )}\n                    </div>\n\n                    <div className=\"flex flex-col\">\n                      <span className=\"text-sm font-medium text-muted-foreground\">\n                        {providerName}\n                      </span>\n\n                      <span className=\"text-xs text-muted-foreground/70\">\n                        {localization.settings.connectProvider.replace(\n                          \"{{provider}}\",\n                          providerName\n                        )}\n                      </span>\n                    </div>\n                  </div>\n\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    onClick={() => linkSocial(provider)}\n                    disabled={\n                      isCurrentlyLinking ||\n                      !!unlinkingProvider ||\n                      !!linkingProvider\n                    }\n                    aria-label={localization.settings.connectProvider.replace(\n                      \"{{provider}}\",\n                      providerName\n                    )}\n                  >\n                    {isCurrentlyLinking ? (\n                      <Spinner className=\"size-4\" />\n                    ) : (\n                      <Link className=\"size-4\" />\n                    )}\n                  </Button>\n                </div>\n              )\n            })}\n          </>\n        )}\n      </CardContent>\n    </Card>\n  )\n}\n\nfunction AccountRowSkeleton() {\n  return (\n    <div className=\"flex items-center rounded-lg border p-3 justify-between\">\n      <div className=\"flex items-center gap-3\">\n        <Skeleton className=\"size-10 rounded-md\" />\n\n        <div className=\"flex flex-col gap-1\">\n          <Skeleton className=\"h-4 w-20\" />\n          <Skeleton className=\"h-3 w-32\" />\n        </div>\n      </div>\n    </div>\n  )\n}\n",
      "type": "registry:component"
    }
  ],
  "type": "registry:component"
}