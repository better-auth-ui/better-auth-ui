{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "accounts",
  "title": "Accounts",
  "description": "Display and manage multiple signed-in accounts for multi-session support. Shows all device sessions, allows switching between accounts, and signing out of individual accounts.",
  "dependencies": [
    "@better-auth-ui/react@*",
    "better-auth",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "card",
    "spinner",
    "user-view"
  ],
  "files": [
    {
      "path": "src/components/settings/account/accounts.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { ArrowLeftRight, LogOut, PlusCircle } from \"lucide-react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport {\n  Card,\n  CardContent,\n  CardFooter,\n  CardHeader,\n  CardTitle\n} from \"@/components/ui/card\"\nimport { Spinner } from \"@/components/ui/spinner\"\nimport { UserView } from \"@/components/user/user-view\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { useSession } from \"@/hooks/auth/use-session\"\nimport { useListDeviceSessions } from \"@/hooks/settings/use-list-device-sessions\"\nimport { useRevokeMultiSession } from \"@/hooks/settings/use-revoke-multi-session\"\nimport { useSetActiveSession } from \"@/hooks/settings/use-set-active-session\"\nimport { cn } from \"@/lib/utils\"\n\nexport type AccountsProps = AnyAuthConfig & {\n  className?: string\n}\n\n/**\n * Display and manage multiple signed-in accounts for multi-session support.\n *\n * Shows all device sessions, allows switching between accounts, and signing out\n * of individual accounts. Shown in AccountSettings when multiSession is enabled.\n *\n * @returns A JSX element containing the accounts card, or null if multiSession is disabled\n */\nexport function Accounts({ className, ...config }: AccountsProps) {\n  const context = useAuth(config)\n  const { basePaths, localization, viewPaths, Link } = context\n\n  const { data: sessionData } = useSession(context)\n  const { data: deviceSessions, isPending } = useListDeviceSessions(context)\n  const { settingActiveSession, setActiveSession } =\n    useSetActiveSession(context)\n  const { revokingSession, revokeSession } = useRevokeMultiSession(context)\n\n  return (\n    <Card className={cn(\"w-full py-4 md:py-6 gap-4 md:gap-6\", className)}>\n      <CardHeader className=\"px-4 md:px-6 gap-0\">\n        <CardTitle className=\"text-xl\">\n          {localization.settings.accounts}\n        </CardTitle>\n      </CardHeader>\n\n      <CardContent className=\"px-4 md:px-6 grid gap-3\">\n        {sessionData && !isPending ? (\n          [\n            sessionData,\n            ...(deviceSessions || []).filter(\n              (deviceSession) =>\n                deviceSession.session.id !== sessionData.session.id\n            )\n          ].map((deviceSession) => {\n            const isActive = deviceSession.session.id === sessionData.session.id\n            const isSwitching =\n              settingActiveSession === deviceSession.session.token\n            const isRevoking = revokingSession === deviceSession.session.token\n\n            return (\n              <div\n                key={deviceSession.session.id}\n                className=\"h-15 flex items-center rounded-xl border p-3 justify-between\"\n              >\n                <UserView {...config} user={deviceSession.user} />\n\n                <div className=\"flex items-center gap-1 shrink-0\">\n                  {!isActive && (\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon-sm\"\n                      onClick={() =>\n                        setActiveSession(deviceSession.session.token)\n                      }\n                      disabled={isSwitching || isRevoking}\n                      aria-label={localization.auth.switchAccount}\n                    >\n                      {isSwitching ? <Spinner /> : <ArrowLeftRight />}\n                    </Button>\n                  )}\n\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon-sm\"\n                    onClick={() => revokeSession(deviceSession.session.token)}\n                    disabled={isSwitching || isRevoking}\n                    aria-label={localization.auth.signOut}\n                  >\n                    {isRevoking ? <Spinner /> : <LogOut />}\n                  </Button>\n                </div>\n              </div>\n            )\n          })\n        ) : (\n          <div className=\"h-15 flex items-center rounded-xl border p-3\">\n            <UserView isPending {...config} />\n          </div>\n        )}\n      </CardContent>\n\n      <CardFooter className=\"px-4 md:px-6\">\n        <Button variant=\"secondary\" asChild disabled={isPending}>\n          <Link\n            href={`${basePaths.auth}/${viewPaths.auth.signIn}`}\n            className={cn(isPending && \"opacity-50 pointer-events-none\")}\n          >\n            <PlusCircle />\n\n            {localization.auth.addAccount}\n          </Link>\n        </Button>\n      </CardFooter>\n    </Card>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/user/user-view.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport type { User } from \"better-auth\"\n\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { useSession } from \"@/hooks/auth/use-session\"\nimport { cn } from \"@/lib/utils\"\nimport { UserAvatar } from \"./user-avatar\"\n\nexport type UserViewProps = AnyAuthConfig & {\n  className?: string\n  isPending?: boolean\n  user?: User & { username?: string | null; displayUsername?: string | null }\n}\n\n/**\n * Render a user view that shows the user's avatar alongside their name and email.\n *\n * @param className - Additional CSS classes applied to the outer container\n * @param isPending - When true, force rendering of the loading skeleton (unless an explicit `user` prop is provided)\n * @param user - Optional user object to display; when omitted the current session user is used if available\n * @returns A React element that displays the user's avatar with their name and email\n */\nexport function UserView({\n  className,\n  isPending,\n  user,\n  ...config\n}: UserViewProps) {\n  const context = useAuth(config)\n\n  const { data: sessionData, isPending: sessionPending } = useSession(context)\n\n  const resolvedUser = user ?? sessionData?.user\n\n  if ((isPending || sessionPending) && !user) {\n    return (\n      <div className={cn(\"flex items-center gap-2\", className)}>\n        <UserAvatar isPending {...config} />\n\n        <div className=\"grid flex-1 gap-1 text-left text-sm\">\n          <Skeleton className=\"h-4 w-24\" />\n          <Skeleton className=\"h-3 w-32\" />\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className={cn(\"flex items-center gap-2\", className)}>\n      <UserAvatar user={resolvedUser} {...config} />\n\n      <div className=\"grid flex-1 text-left text-sm leading-tight\">\n        <span className=\"truncate font-medium\">\n          {resolvedUser?.displayUsername ||\n            resolvedUser?.name ||\n            resolvedUser?.email}\n        </span>\n\n        {(resolvedUser?.displayUsername || resolvedUser?.name) && (\n          <span className=\"text-muted-foreground truncate text-xs\">\n            {resolvedUser?.email}\n          </span>\n        )}\n      </div>\n    </div>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/hooks/auth/use-auth.tsx",
      "content": "import {\n  type AnyAuthConfig,\n  type AuthConfig,\n  AuthContext\n} from \"@better-auth-ui/react\"\nimport { deepmerge, defaultConfig } from \"@better-auth-ui/react/core\"\nimport { useContext } from \"react\"\nimport { toast } from \"sonner\"\n\nconst extendConfig: AnyAuthConfig = {\n  toast,\n  Link: (props) => <a {...props} />\n}\n\n/**\n * Constructs the effective AuthConfig by merging defaults, any AuthContext-provided config, and the optional `config` overrides.\n *\n * @param config - Partial configuration overrides applied on top of context and defaults\n * @returns The final `AuthConfig` with a non-optional `authClient`\n * @throws If the resulting config does not include an `authClient`\n */\nexport function useAuth(config?: AnyAuthConfig) {\n  const context = useContext(AuthContext)\n\n  const authConfig = deepmerge(\n    deepmerge(defaultConfig as AnyAuthConfig, extendConfig),\n    deepmerge(context || {}, config || {})\n  ) as AuthConfig\n\n  if (authConfig.authClient === undefined) {\n    throw new Error(\"[Better Auth UI] authClient is required\")\n  }\n\n  return authConfig\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "src/hooks/auth/use-session.ts",
      "content": "export { useSession } from \"@better-auth-ui/react\"\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/auth/use-session.tsx",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { type DefinedInitialDataOptions, useQuery } from \"@tanstack/react-query\"\n\nimport { useAuth } from \"../auth/use-auth\"\n\n/**\n * Fetches and returns the session data.\n *\n * @param config - Optional partial AuthConfig used to customize auth behavior; may include an `authClient` override.\n * @param options - Optional query options.\n * @returns Query result containing session data, loading state, and error state\n */\nexport function useSession(\n  config?: AnyAuthConfig,\n  options?: Partial<DefinedInitialDataOptions>\n) {\n  const { authClient, queryClient } = useAuth(config)\n\n  return useQuery(\n    {\n      queryKey: [\"auth\", \"session\"],\n      queryFn: () => authClient.getSession({ fetchOptions: { throw: true } }),\n      ...(options as object)\n    },\n    queryClient\n  )\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/settings/use-list-device-sessions.ts",
      "content": "import { type AnyAuthConfig, useSession } from \"@better-auth-ui/react\"\nimport { type DefinedInitialDataOptions, useQuery } from \"@tanstack/react-query\"\nimport { useAuth } from \"../auth/use-auth\"\n\n/**\n * Fetches and returns the list of device sessions for multi-session support.\n *\n * @param config - Optional partial AuthConfig used to customize auth behavior; may include an `authClient` override.\n * @param options - Optional query options.\n * @returns Query result containing device sessions data, loading state, and error state\n */\nexport function useListDeviceSessions(\n  config?: AnyAuthConfig,\n  options?: DefinedInitialDataOptions\n) {\n  const { authClient, multiSession, queryClient } = useAuth(config)\n  const { data: sessionData } = useSession(config, options)\n\n  return useQuery(\n    {\n      queryKey: [\"auth\", \"multiSession\", \"listDeviceSessions\"],\n      queryFn: async () =>\n        authClient.multiSession.listDeviceSessions({\n          fetchOptions: { throw: true }\n        }),\n      enabled: multiSession && !!sessionData,\n      ...(options as object)\n    },\n    queryClient\n  )\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/settings/use-set-active-session.ts",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { useCallback, useState } from \"react\"\n\nimport { useAuth } from \"../auth/use-auth\"\n\n/**\n * Provides functionality to set an active session from device sessions in multi-session mode.\n *\n * @param config - Optional auth configuration forwarded to the auth hook\n * @returns An object containing the pending session token and a function to set the active session\n */\nexport function useSetActiveSession(config?: AnyAuthConfig) {\n  const { authClient, queryClient, toast } = useAuth(config)\n\n  const [settingActiveSession, setSettingActiveSession] = useState<\n    string | null\n  >(null)\n\n  const setActiveSession = useCallback(\n    async (sessionToken: string) => {\n      setSettingActiveSession(sessionToken)\n\n      const { error } = await authClient.multiSession.setActive({\n        sessionToken\n      })\n\n      if (error) {\n        toast.error(error.message || error.statusText)\n      } else {\n        await queryClient.invalidateQueries({ queryKey: [\"auth\"] })\n      }\n\n      setSettingActiveSession(null)\n    },\n    [authClient, queryClient, toast]\n  )\n\n  return { settingActiveSession, setActiveSession }\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/settings/use-revoke-multi-session.ts",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { useCallback, useState } from \"react\"\n\nimport { useAuth } from \"../auth/use-auth\"\n\n/**\n * Provides functionality to revoke a session from device sessions in multi-session mode.\n * This is used for the multi-session plugin where users can have multiple accounts on the same device.\n *\n * @param config - Optional auth configuration forwarded to the auth hook\n * @returns An object containing the revoking session token and a function to revoke a session\n */\nexport function useRevokeMultiSession(config?: AnyAuthConfig) {\n  const { authClient, queryClient, toast } = useAuth(config)\n\n  const [revokingSession, setRevokingSession] = useState<string | null>(null)\n\n  const revokeSession = useCallback(\n    async (sessionToken: string) => {\n      setRevokingSession(sessionToken)\n\n      const { error } = await authClient.multiSession.revoke({\n        sessionToken\n      })\n\n      if (error) {\n        toast.error(error.message || error.statusText)\n      } else {\n        await queryClient.invalidateQueries({ queryKey: [\"auth\"] })\n      }\n\n      setRevokingSession(null)\n    },\n    [authClient, queryClient, toast]\n  )\n\n  return { revokingSession, revokeSession }\n}\n\n",
      "type": "registry:hook"
    }
  ],
  "type": "registry:component"
}