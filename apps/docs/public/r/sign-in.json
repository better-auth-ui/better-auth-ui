{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "sign-in",
  "title": "Sign In",
  "description": "A complete sign-in form component with email/password, magic link, and social provider support.",
  "dependencies": [
    "@better-auth-ui/react@*",
    "better-auth",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "card",
    "input",
    "label",
    "checkbox",
    "separator",
    "field",
    "sonner",
    "spinner"
  ],
  "files": [
    {
      "path": "src/components/auth/sign-in.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { useState } from \"react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Checkbox } from \"@/components/ui/checkbox\"\nimport {\n  Field,\n  FieldDescription,\n  FieldError,\n  FieldGroup,\n  FieldLabel,\n  FieldSeparator\n} from \"@/components/ui/field\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Spinner } from \"@/components/ui/spinner\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { useSignInEmail } from \"@/hooks/auth/use-sign-in-email\"\nimport { useSignInSocial } from \"@/hooks/auth/use-sign-in-social\"\nimport { cn } from \"@/lib/utils\"\nimport { MagicLinkButton } from \"./magic-link-button\"\nimport { ProviderButtons, type SocialLayout } from \"./provider-buttons\"\n\nexport type SignInProps = AnyAuthConfig & {\n  className?: string\n  socialLayout?: SocialLayout\n  socialPosition?: \"top\" | \"bottom\"\n}\n\n/**\n * Renders the Sign In UI with email/password, magic link, and social provider\n * options based on the provided `AuthConfig`.\n */\nexport function SignIn({\n  className,\n  socialLayout,\n  socialPosition = \"bottom\",\n  ...config\n}: SignInProps) {\n  const context = useAuth(config)\n\n  const {\n    basePaths,\n    emailAndPassword,\n    localization,\n    magicLink,\n    socialProviders,\n    viewPaths,\n    Link\n  } = context\n\n  const [{ email, password }, signInEmail, signInPending] =\n    useSignInEmail(context)\n\n  const [_, signInSocial, socialPending] = useSignInSocial(context)\n\n  const isPending = signInPending || socialPending\n\n  const [fieldErrors, setFieldErrors] = useState<{\n    email?: string\n    password?: string\n  }>({})\n\n  const showSeparator =\n    emailAndPassword?.enabled && socialProviders && socialProviders.length > 0\n\n  return (\n    <Card className={cn(\"w-full max-w-sm py-4 md:py-6\", className)}>\n      <CardHeader className=\"px-4 md:px-6 -mb-4\">\n        <CardTitle className=\"text-xl\">{localization.auth.signIn}</CardTitle>\n      </CardHeader>\n\n      <CardContent className=\"px-4 md:px-6\">\n        <FieldGroup className=\"gap-4\">\n          {socialPosition === \"top\" && (\n            <>\n              {socialProviders && socialProviders.length > 0 && (\n                <ProviderButtons\n                  {...config}\n                  socialLayout={socialLayout}\n                  signInSocial={signInSocial}\n                  isPending={isPending}\n                />\n              )}\n\n              {showSeparator && (\n                <FieldSeparator className=\"*:data-[slot=field-separator-content]:bg-card m-0 text-xs flex items-center\">\n                  {localization.auth.or}\n                </FieldSeparator>\n              )}\n            </>\n          )}\n\n          {emailAndPassword?.enabled && (\n            <form action={signInEmail}>\n              <FieldGroup className=\"gap-4\">\n                <Field className=\"gap-1\">\n                  <FieldLabel htmlFor=\"email\">\n                    {localization.auth.email}\n                  </FieldLabel>\n\n                  <Input\n                    id=\"email\"\n                    name=\"email\"\n                    type=\"email\"\n                    autoComplete=\"email\"\n                    defaultValue={email}\n                    placeholder={localization.auth.emailPlaceholder}\n                    required\n                    disabled={isPending}\n                    onChange={() => {\n                      setFieldErrors((prev) => ({\n                        ...prev,\n                        email: undefined\n                      }))\n                    }}\n                    onInvalid={(e) => {\n                      e.preventDefault()\n                      setFieldErrors((prev) => ({\n                        ...prev,\n                        email: (e.target as HTMLInputElement).validationMessage\n                      }))\n                    }}\n                    aria-invalid={!!fieldErrors.email}\n                  />\n\n                  <FieldError>{fieldErrors.email}</FieldError>\n                </Field>\n\n                <Field className=\"gap-1\">\n                  <div className=\"flex items-center\">\n                    <FieldLabel htmlFor=\"password\">\n                      {localization.auth.password}\n                    </FieldLabel>\n\n                    {!emailAndPassword?.rememberMe &&\n                      emailAndPassword?.forgotPassword && (\n                        <Link\n                          href={`${basePaths.auth}/${viewPaths.auth.forgotPassword}`}\n                          className=\"ml-auto inline-block text-sm underline-offset-4 hover:underline text-card-foreground!\"\n                        >\n                          {localization.auth.forgotPasswordLink}\n                        </Link>\n                      )}\n                  </div>\n\n                  <Input\n                    id=\"password\"\n                    name=\"password\"\n                    type=\"password\"\n                    autoComplete=\"current-password\"\n                    defaultValue={password}\n                    placeholder={localization.auth.passwordPlaceholder}\n                    required\n                    minLength={emailAndPassword?.minPasswordLength}\n                    maxLength={emailAndPassword?.maxPasswordLength}\n                    disabled={isPending}\n                    onChange={() => {\n                      setFieldErrors((prev) => ({\n                        ...prev,\n                        password: undefined\n                      }))\n                    }}\n                    onInvalid={(e) => {\n                      e.preventDefault()\n\n                      setFieldErrors((prev) => ({\n                        ...prev,\n                        password: (e.target as HTMLInputElement)\n                          .validationMessage\n                      }))\n                    }}\n                    aria-invalid={!!fieldErrors.password}\n                  />\n\n                  <FieldError>{fieldErrors.password}</FieldError>\n                </Field>\n\n                {emailAndPassword.rememberMe && (\n                  <Field className=\"my-1\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex items-center gap-2\">\n                        <Checkbox\n                          id=\"rememberMe\"\n                          name=\"rememberMe\"\n                          disabled={isPending}\n                        />\n\n                        <Label\n                          htmlFor=\"rememberMe\"\n                          className=\"cursor-pointer text-sm font-normal\"\n                        >\n                          {localization.auth.rememberMe}\n                        </Label>\n                      </div>\n\n                      {emailAndPassword?.forgotPassword && (\n                        <Link\n                          href={`${basePaths.auth}/${viewPaths.auth.forgotPassword}`}\n                          className=\"ml-auto inline-block text-sm underline-offset-4 hover:underline text-card-foreground!\"\n                        >\n                          {localization.auth.forgotPasswordLink}\n                        </Link>\n                      )}\n                    </div>\n                  </Field>\n                )}\n\n                <Field className=\"mt-1\">\n                  <Button type=\"submit\" disabled={isPending}>\n                    {isPending && <Spinner />}\n\n                    {localization.auth.signIn}\n                  </Button>\n\n                  {magicLink && (\n                    <MagicLinkButton\n                      {...config}\n                      view=\"signIn\"\n                      isPending={isPending}\n                    />\n                  )}\n                </Field>\n              </FieldGroup>\n            </form>\n          )}\n\n          {socialPosition === \"bottom\" && (\n            <>\n              {showSeparator && (\n                <FieldSeparator className=\"*:data-[slot=field-separator-content]:bg-card m-0 text-xs flex items-center\">\n                  {localization.auth.or}\n                </FieldSeparator>\n              )}\n\n              {socialProviders && socialProviders.length > 0 && (\n                <ProviderButtons\n                  {...config}\n                  socialLayout={socialLayout}\n                  signInSocial={signInSocial}\n                  isPending={isPending}\n                />\n              )}\n            </>\n          )}\n\n          {emailAndPassword?.enabled && (\n            <FieldDescription className=\"flex justify-center gap-1\">\n              {localization.auth.needToCreateAnAccount}\n\n              <Link\n                href={`${basePaths.auth}/${viewPaths.auth.signUp}`}\n                className=\"underline underline-offset-4\"\n              >\n                {localization.auth.signUp}\n              </Link>\n            </FieldDescription>\n          )}\n        </FieldGroup>\n      </CardContent>\n    </Card>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/auth/magic-link-button.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport type { AuthView } from \"@better-auth-ui/react/core\"\nimport { Lock, Mail } from \"lucide-react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { cn } from \"@/lib/utils\"\n\nexport type MagicLinkButtonProps = AnyAuthConfig & {\n  isPending: boolean\n  view?: AuthView\n}\n\n/**\n * A button that links to either the magic-link or sign-in route and displays the corresponding icon and label.\n *\n * @param isPending - If true, apply disabled styling and prevent interactions\n * @param view - Current auth view; when `\"magicLink\"`, the button shows the password/sign-in variant\n */\nexport function MagicLinkButton({\n  isPending,\n  view,\n  ...config\n}: MagicLinkButtonProps) {\n  const { basePaths, viewPaths, localization, Link } = useAuth(config)\n\n  const isMagicLinkView = view === \"magicLink\"\n\n  return (\n    <Button\n      type=\"button\"\n      variant=\"outline\"\n      disabled={isPending}\n      className={cn(\"w-full\", isPending && \"opacity-50 pointer-events-none\")}\n      asChild\n    >\n      <Link\n        href={`${basePaths.auth}/${isMagicLinkView ? viewPaths.auth.signIn : viewPaths.auth.magicLink}`}\n      >\n        {isMagicLinkView ? <Lock /> : <Mail />}\n\n        {localization.auth.continueWith.replace(\n          \"{{provider}}\",\n          isMagicLinkView\n            ? localization.auth.password\n            : localization.auth.magicLink\n        )}\n      </Link>\n    </Button>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/auth/provider-buttons.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { providerIcons } from \"@better-auth-ui/react\"\nimport { getProviderName } from \"@better-auth-ui/react/core\"\nimport { useMemo } from \"react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport { Field } from \"@/components/ui/field\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { cn } from \"@/lib/utils\"\n\nexport type ProviderButtonsProps = AnyAuthConfig & {\n  isPending: boolean\n  socialLayout?: SocialLayout\n  signInSocial: (formData: FormData) => void\n}\n\nexport type SocialLayout = \"auto\" | \"horizontal\" | \"vertical\" | \"grid\"\n\n/**\n * Render social provider sign-in buttons and handle sign-in initiation and pending state.\n *\n * @param isPending - When true, disables all provider buttons.\n * @param socialLayout - Preferred layout for the provider buttons; when set to `\"auto\"` the layout is chosen based on the number of available providers.\n * @param signInSocial - The function to call when a social provider button is clicked.\n */\nexport function ProviderButtons({\n  isPending,\n  socialLayout = \"auto\",\n  signInSocial,\n  ...config\n}: ProviderButtonsProps) {\n  const { localization, socialProviders } = useAuth(config)\n\n  const resolvedSocialLayout = useMemo(() => {\n    if (socialLayout === \"auto\") {\n      if (socialProviders?.length && socialProviders.length >= 4) {\n        return \"horizontal\"\n      }\n\n      return \"vertical\"\n    }\n\n    return socialLayout\n  }, [socialLayout, socialProviders?.length])\n\n  return (\n    <form action={signInSocial}>\n      <Field\n        className={cn(\n          \"gap-3\",\n          resolvedSocialLayout === \"grid\" && \"grid grid-cols-2\",\n          resolvedSocialLayout === \"vertical\" && \"flex-col\",\n          resolvedSocialLayout === \"horizontal\" && \"flex-row flex-wrap\"\n        )}\n      >\n        {socialProviders?.map((provider) => {\n          const ProviderIcon = providerIcons[provider]\n\n          return (\n            <Button\n              key={provider}\n              name=\"provider\"\n              value={provider}\n              className={cn(\n                \"flex-1\",\n                resolvedSocialLayout === \"horizontal\" && \"flex-1\"\n              )}\n              variant=\"outline\"\n              type=\"submit\"\n              disabled={isPending}\n            >\n              <ProviderIcon />\n\n              {resolvedSocialLayout === \"vertical\"\n                ? localization.auth.continueWith.replace(\n                    \"{{provider}}\",\n                    getProviderName(provider)\n                  )\n                : resolvedSocialLayout === \"grid\"\n                  ? getProviderName(provider)\n                  : null}\n            </Button>\n          )\n        })}\n      </Field>\n    </form>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/hooks/auth/use-auth.tsx",
      "content": "import {\n  type AnyAuthConfig,\n  type AuthConfig,\n  AuthContext\n} from \"@better-auth-ui/react\"\nimport { deepmerge, defaultConfig } from \"@better-auth-ui/react/core\"\nimport { useContext } from \"react\"\nimport { toast } from \"sonner\"\n\nconst extendConfig: AnyAuthConfig = {\n  toast,\n  Link: (props) => <a {...props} />\n}\n\n/**\n * Constructs the effective AuthConfig by merging defaults, any AuthContext-provided config, and the optional `config` overrides.\n *\n * @param config - Partial configuration overrides applied on top of context and defaults\n * @returns The final `AuthConfig` with a non-optional `authClient`\n * @throws If the resulting config does not include an `authClient`\n */\nexport function useAuth(config?: AnyAuthConfig) {\n  const context = useContext(AuthContext)\n\n  const authConfig = deepmerge(\n    deepmerge(defaultConfig as AnyAuthConfig, extendConfig),\n    deepmerge(context || {}, config || {})\n  ) as AuthConfig\n\n  if (authConfig.authClient === undefined) {\n    throw new Error(\"[Better Auth UI] authClient is required\")\n  }\n\n  return authConfig\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/auth/use-authenticate.ts",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport type { DefinedInitialDataOptions } from \"@tanstack/react-query\"\nimport { useEffect } from \"react\"\n\nimport { useAuth } from \"./use-auth\"\nimport { useSession } from \"./use-session\"\n\n/**\n * Redirects unauthenticated users to the sign-in page (preserving the current URL) and exposes the active auth session.\n *\n * @param config - Optional partial AuthConfig used to customize auth behavior.\n * @param options - Optional query options for the underlying session query.\n * @returns Result of useSession hook containing session data and query state.\n */\nexport function useAuthenticate(\n  config?: AnyAuthConfig,\n  options?: Partial<DefinedInitialDataOptions>\n) {\n  const { basePaths, viewPaths, replace } = useAuth(config)\n  const { data, isPending, ...rest } = useSession(config, options)\n\n  useEffect(() => {\n    if (data || isPending) return\n\n    const currentURL = window.location.pathname + window.location.search\n    const redirectTo = encodeURIComponent(currentURL)\n    const signInPath = `${basePaths.auth}/${viewPaths.auth.signIn}?redirectTo=${redirectTo}`\n\n    replace(signInPath)\n  }, [basePaths.auth, data, isPending, viewPaths.auth.signIn, replace])\n\n  return { data, isPending, ...rest }\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/auth/use-sign-in-email.ts",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { useActionState } from \"react\"\n\nimport { useAuth } from \"./use-auth\"\nimport { useRedirectTo } from \"./use-redirect-to\"\n\nexport function useSignInEmail(config?: AnyAuthConfig) {\n  const {\n    authClient,\n    baseURL,\n    emailAndPassword,\n    localization,\n    queryClient,\n    toast,\n    navigate\n  } = useAuth(config)\n\n  const redirectTo = useRedirectTo(config)\n\n  const signInEmail = async (_: object, formData: FormData) => {\n    const email = formData.get(\"email\") as string\n    const password = formData.get(\"password\") as string\n    const rememberMe = formData.get(\"rememberMe\") === \"on\"\n\n    const { error } = await authClient.signIn.email({\n      email,\n      password,\n      ...(emailAndPassword?.rememberMe ? { rememberMe } : {})\n    })\n\n    if (error) {\n      if (error.code === \"EMAIL_NOT_VERIFIED\") {\n        const toastId = toast.error(error.message || error.statusText, {\n          action: {\n            label: localization.auth.resend,\n            onClick: async () => {\n              const callbackURL = `${baseURL}${redirectTo}`\n\n              toast.dismiss?.(toastId)\n\n              const { error } = await authClient.sendVerificationEmail({\n                email,\n                callbackURL\n              })\n\n              if (error) {\n                toast.error(error.message || error.statusText)\n              } else {\n                toast.success(localization.auth.verificationEmailSent)\n              }\n            }\n          }\n        })\n      } else {\n        toast.error(error.message || error.statusText)\n      }\n\n      return {\n        email,\n        password: \"\"\n      }\n    }\n\n    await queryClient.invalidateQueries({ queryKey: [\"auth\"] })\n\n    navigate(redirectTo)\n\n    return { email, password }\n  }\n\n  return useActionState(signInEmail, {\n    email: \"\",\n    password: \"\"\n  })\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/auth/use-sign-in-social.ts",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { useActionState } from \"react\"\n\nimport { useAuth } from \"./use-auth\"\nimport { useRedirectTo } from \"./use-redirect-to\"\n\nexport function useSignInSocial(config?: AnyAuthConfig) {\n  const { authClient, baseURL, toast } = useAuth(config)\n  const redirectTo = useRedirectTo(config)\n\n  const signInSocial = async (_: object, formData: FormData) => {\n    const provider = formData.get(\"provider\") as string\n\n    const callbackURL = `${baseURL}${redirectTo}`\n\n    const { error } = await authClient.signIn.social({\n      provider,\n      callbackURL\n    })\n\n    if (error) toast.error(error.message || error.statusText)\n\n    return { provider }\n  }\n\n  return useActionState(signInSocial, { provider: \"\" })\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/auth/use-redirect-to.ts",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\n\nimport { useHydrated } from \"../use-hydrated\"\nimport { useAuth } from \"./use-auth\"\n\n/**\n * Reads and validates the `redirectTo` query parameter from the URL to prevent open redirect vulnerabilities.\n *\n * When the app is hydrated, reads the `redirectTo` query parameter and validates it:\n * - Must be a relative path starting with \"/\" but not \"//\"\n * - Must not contain a scheme (e.g., \"://\")\n * - Must not contain backslashes (browsers can normalize \"\\\" to \"/\" making \"/\\evil.com\" become \"//evil.com\")\n *\n * @returns The validated redirect path, or `undefined` if not present or invalid\n */\nexport function useRedirectTo(config?: AnyAuthConfig) {\n  const { redirectTo } = useAuth(config)\n  const hydrated = useHydrated()\n\n  // Validate redirectTo from URL search params to prevent open redirect vulnerabilities\n  if (hydrated) {\n    const redirectToParam = new URLSearchParams(window.location.search)\n      .get(\"redirectTo\")\n      ?.trim()\n\n    if (redirectToParam) {\n      // Validate: must be a relative path starting with \"/\" but not \"//\"\n      // and must not contain a scheme (e.g., \"://\") or backslashes\n      // (browsers can normalize \"\\\" to \"/\" making \"/\\evil.com\" become \"//evil.com\")\n      const isValidRedirect =\n        redirectToParam.startsWith(\"/\") &&\n        !redirectToParam.startsWith(\"//\") &&\n        !redirectToParam.includes(\"://\") &&\n        !redirectToParam.includes(\"\\\\\")\n\n      if (isValidRedirect) {\n        return redirectToParam\n      }\n    }\n  }\n\n  return redirectTo\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/use-hydrated.ts",
      "content": "import { useSyncExternalStore } from \"react\"\n\n/**\n * Indicates whether the current rendering context is hydrated (client-side).\n *\n * @returns `true` when running on the client (hydrated), `false` when rendering on the server\n */\nexport function useHydrated() {\n  return useSyncExternalStore(\n    subscribe,\n    () => true,\n    () => false\n  )\n}\n\n/**\n * Create a subscription handler that does nothing and returns a no-op cleanup.\n *\n * @returns A cleanup function that performs no action when invoked.\n */\nfunction subscribe() {\n  return () => {}\n}\n",
      "type": "registry:hook"
    }
  ],
  "type": "registry:component"
}